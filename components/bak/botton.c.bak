#include<wiringPi.h>
#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>
#include<signal.h>

#define BEEP 13
#define KEY 26

void catch_sigint(int signo){
    puts("catch ctrl+c");
    digitalWrite(BEEP , 0);
    signal(2 , SIG_DFL);
    exit(0);
}

int main(void){
    if(wiringPiSetupGpio() < 0){
        perror("启动树梅派GPIO失败");
        exit(1);
    }
    signal(SIGINT , catch_sigint);
    pinMode(BEEP , OUTPUT);
    digitalWrite(BEEP , 0);
    pinMode(KEY , INPUT);
    while(1){
        // if(digitalRead(KEY)){
        //     usleep(20000);
        //     if(digitalRead(KEY)) {
        //         puts("key precess");
        //         while (digitalRead(KEY));
        //         if(digitalRead(BEEP) == 0)
        //             digitalWrite(BEEP , 1);
        //         else digitalWrite(BEEP , 0);
        //     }
        // }
        while(digitalRead(KEY)){
            digitalWrite(BEEP , 1);
        }
        digitalWrite(BEEP , 0);
    }
}